## Advent of cyber 2025

### Day 4

* Security testing types:
- SAST: static application security testing (for scanning code)
- DAST: dynamic application security testing (scans running apps for vulnerabilities)

### Day 5

* IDOR: Insecure Direct Object References (access control vulnerability)

* privilege escalation:
- vertical: gaining access to more features
- horizontal: using features you are authorized to use, but gaining access to data you are not.

* IDOR is usually a form of horizontal privilege escalation.

* techniques to hide potential IDOR: (not efficient)
- encoding: Base64...
- hashing: md5...
- uuid (can be decoded: online decoder)

* instead use random or hard to guess IDs

* the issue with UUID1 is if we know the exact date when the code was generated, we can recover the uuid.

### Day 6

* malware analysis branches:
- static: focuses on inspecting a file without executing it
- dynamic: involves executing it

* sandboxes (safe isolated envs): think of this as disposable digital play-pens
- VMs are a popular choice: snapshotting...

* connection to remote machine (sandbox) is gonna be via rdp
- to connect to windows from linux client via rdp:
```sh
sudo apt install remmina
```

* malicious code and apps are referred to as samples

* rules:
- never run dangerous apps on devices you care about

* tools of the trade: pestudio, procmon, regshot...

* informations gathered from static analysis:
- checksums: track and catalogue files/execs (can google it to check if already identified)
- strings: sequences of readable chars (IPs, URLs, commands, passwords...)
- imports: librairies, functions (OS...)
- resources: data (images...) -> malware is known to be hidden in this section

* you cannot truly know how a sample functions until it is executed
- attackers use techniques like "obfuscation" to obscure how a sample appears, to evade anti-viruses/analysts

* PeStudio (Usage): static analysis

- gathering information:
1. launch pestudio
2. load the executable
3. click in "indicators" tab in dropdown
4. look for sha256sum (unique identifier for the executable: keep note of it)
5. reviewing strings ("strings" indicator on left panel)

* RegShot (Usage): dynamic analysis (on Windows)

- creates 2 snapshots of the registry before and after running the sample, and compares them.

- malware aims to establish persistense (seeks to run as soon as the device is switched on)
-> common technique: adds 'Run' key to the registry ('Run' is frequently used to specify startup apps)

- Steps:
1. launch regshot
2. log as 'html doc'
3. path as 'Desktop'
4. 1st shot > Shot
5. execute the sample
6. 2nd shot > Shot
7. compare (use 'txt', 'html' is not working properly (corrupted))

* ProcMon (Usage): dynamic analysis

- from sysinternals suite

- for monitoring and investigating how processes are interacting with windowsOS (allows to see exacly what a process is doing)

- Steps:
1. launch procmon
2. execute the sample
3. stop capturing more events
4. filter > filter (process name + is + "HopHelper.exe")
5. Note: operation of interest: RegOpenKey, CreateFile, TCP Connect, TCP Receive
6. filter > filter (operation + contains + "TCP")
7. check for used network protocol in 'path' panel
8. filter > reset filter (to start over)

- Bonus:
using wireshar (loopback interface), i found that HopHelper.exe is communicating with a internet panel and shares collected system info !!!!


* DFIR tools folder !!!!!!!!!

## Day 7

* Network and port discovery tools: netcat, nmap, naabu

* nmap (Usage):

```sh
nmap MACHINE_IP
# scans top 1000 ports
nmap -p- --script=banner MACHINE_IP
# -p- : scans whole range
# --script=banner : what's likely behind the port !
```

* ftp (Usage):

```sh
ftp MACHINE_IP PORT
# try to login with: 'anonymous' mode
ftp> passive # switching passive mode off
ftp> ls # list files
ftp> get tbfc_qa_key1 - # downloads the file and prints it
ftp> ! # exits ftp shell
```

* port scan modes:
- when the service running on a port isn't well-known, use 'netcat' (universal tool to interact with network services)

```sh
nc -v MACHINE_IP PORT
# -v: verbose
```

* UDP scan (with nmap)

```sh
nmap -sU MACHINE_IP
# another 65535 ports to scan
# upd scan requires root privileges
```

* DNS

```sh
dig @MACHINE_IP TXT key3.tbfc.local +short
# dig: performs advanced dns queries
# basic usage: dig [@server_ip:optional] [domain:required] [type:optional]
# !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! (how should i know ?!)
```

* list listening ports:
```sh
ss -tunlp # OR netstat for older systems
# lists also services listening on 127.0.0.1 (available only from the host)
# can also view process column (with root permissions)
```

* mysql
- usually databases require password for remote clients, but allow unauthorized logins from localhost

```sh
mysql -D tbfcqa01 -e "show tables;"
# -D: database
# -e: execute
mysql -D tbfcqa01 -e "select * from flags;"
# OR:
mysql
mysql> show databases;
mysql> use tbfcqa01;
mysql> show tables;
mysql> select * from flags;
```